import{b as L,$ as J,a0 as K,r as _,e as C,c as U,m as t,k as a,x as m,w as f,E as S,y as O,z as Q,Z as P,B as W,A as R,O as X,v as T,o as Y,j as h,q as A,t as $,a1 as z,C as w,F as ee,S as ae,U as te,a2 as le}from"./.pnpm-DQd76FlD.js";import{i as E}from"./index-DHyaBMsj.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne=n=>E.post("/admin/group",n),ue=n=>E.get(`/admin/group?page=${n.page}&size=${n.size}`),se=n=>E.patch(`/admin/group/${n.id}`,n),de=n=>E.delete("/admin/group",{data:{group_ids:[n.id]}}),ie=n=>E.delete("/admin/group",{data:{group_ids:n}}),pe=L({__name:"AddGroup",props:{modelValue:{},modelModifiers:{}},emits:J(["getGroups"],["update:modelValue"]),setup(n,{emit:i}){const b=i,y=K(n,"modelValue"),g=_(!1),s=_({name:"",count:0,size:0}),p=_(null),x={name:[{required:!0,message:"请输入组名",trigger:"blur"}],count:[{required:!0,message:"请输入可解析文件个数",trigger:"blur"}],size:[{required:!0,message:"请输入可解析大小",trigger:"blur"}]},M=async V=>{if(!(!V||!await V.validate()))try{g.value=!0,await ne(s.value),S.success("添加成功")}finally{g.value=!1}},F=V=>{b("getGroups"),V()},B=()=>{y.value=!1,b("getGroups")};return(V,u)=>{const G=O,k=Q,l=P,o=W,c=R,r=X,D=T;return C(),U(r,{title:"添加用户组",width:"60%",modelValue:y.value,"onUpdate:modelValue":u[5]||(u[5]=d=>y.value=d),"before-close":F},{footer:t(()=>[a(c,{type:"info",onClick:u[3]||(u[3]=d=>B())},{default:t(()=>[m("取消")]),_:1}),a(c,{type:"primary",onClick:u[4]||(u[4]=d=>M(p.value))},{default:t(()=>[m("添加")]),_:1})]),default:t(()=>[f((C(),U(o,{ref_key:"addGroupFormRef",ref:p,model:s.value,rules:x,"label-width":"auto"},{default:t(()=>[a(k,{label:"组名",prop:"name"},{default:t(()=>[a(G,{modelValue:s.value.name,"onUpdate:modelValue":u[0]||(u[0]=d=>s.value.name=d)},null,8,["modelValue"])]),_:1}),a(k,{label:"可解析文件个数",prop:"count"},{default:t(()=>[a(l,{modelValue:s.value.count,"onUpdate:modelValue":u[1]||(u[1]=d=>s.value.count=d)},null,8,["modelValue"])]),_:1}),a(k,{label:"可解析大小",prop:"size"},{default:t(()=>[a(l,{modelValue:s.value.size,"onUpdate:modelValue":u[2]||(u[2]=d=>s.value.size=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[D,g.value]])]),_:1},8,["modelValue"])}}}),re=L({__name:"GroupManagement",setup(n){const i=_(!1),b=_(15),y=_(1),g=_(),s=_([]),p=async()=>{try{i.value=!0;const l=await ue({page:y.value,size:b.value});g.value=l.data}finally{i.value=!1}},x=async l=>{l.edit=!(l.edit??!1)},M=async l=>{l.edit=!(l.edit??!0),await F(l)},F=async l=>{try{i.value=!0,await se(l),S.success("修改用户组成功")}finally{i.value=!1,await p()}},B=async l=>{try{i.value=!0,await de(l),S.success("删除用户组成功")}finally{i.value=!1,await p()}},V=async()=>{try{i.value=!0;const l=s.value.map(o=>o.id);await ie(l),S.success("批量删除用户组成功")}finally{i.value=!1,await p()}},u=l=>s.value=l;Y(p);const G=_(!1),k=()=>G.value=!G.value;return(l,o)=>{var I,N,q;const c=R,r=ae,D=O,d=P,j=te,Z=le,H=T;return C(),h(ee,null,[a(pe,{onGetGroups:p,modelValue:G.value,"onUpdate:modelValue":o[0]||(o[0]=e=>G.value=e)},null,8,["modelValue"]),a(c,{type:"primary",onClick:o[1]||(o[1]=e=>p())},{default:t(()=>[m("刷新列表")]),_:1}),a(c,{type:"primary",onClick:o[2]||(o[2]=e=>k())},{default:t(()=>[m("添加用户组")]),_:1}),a(c,{type:"danger",disabled:s.value.length<=0,onClick:o[3]||(o[3]=e=>V())},{default:t(()=>[m(" 批量删除 ")]),_:1},8,["disabled"]),f((C(),U(j,{data:((I=g.value)==null?void 0:I.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:u},{default:t(()=>[a(r,{type:"selection",width:"40"}),a(r,{prop:"id",label:"ID"}),a(r,{prop:"name",label:"组名"},{default:t(({row:e})=>[f(A("span",null,$(e.name),513),[[z,!e.edit]]),f(a(D,{modelValue:e.name,"onUpdate:modelValue":v=>e.name=v},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),a(r,{prop:"count",label:"可解析文件数量"},{default:t(({row:e})=>[f(A("span",null,$(e.count),513),[[z,!e.edit]]),f(a(d,{modelValue:e.count,"onUpdate:modelValue":v=>e.count=v},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),a(r,{prop:"size",label:"可解析大小"},{default:t(({row:e})=>[f(A("span",null,$(e.size),513),[[z,!e.edit]]),f(a(d,{modelValue:e.size,"onUpdate:modelValue":v=>e.size=v},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),a(r,{prop:"created_at",label:"创建时间"},{default:t(({row:e})=>[m($(new Date(e.created_at).toLocaleString()),1)]),_:1}),a(r,{prop:"updated_at",label:"更新时间"},{default:t(({row:e})=>[m($(new Date(e.updated_at).toLocaleString()),1)]),_:1}),a(r,{width:"150",label:"操作",fixed:"right"},{default:t(({row:e})=>[e.edit?w("",!0):(C(),U(c,{key:0,size:"small",type:"primary",onClick:v=>x(e)},{default:t(()=>[m(" 编辑 ")]),_:2},1032,["onClick"])),e.edit?(C(),U(c,{key:1,size:"small",type:"primary",onClick:v=>M(e)},{default:t(()=>[m(" 保存 ")]),_:2},1032,["onClick"])):w("",!0),a(c,{size:"small",type:"danger",onClick:v=>B(e)},{default:t(()=>[m("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,i.value]]),a(Z,{"current-page":y.value,"onUpdate:currentPage":o[4]||(o[4]=e=>y.value=e),"page-size":b.value,"onUpdate:pageSize":o[5]||(o[5]=e=>b.value=e),"page-sizes":[15,50,100,500,((N=g.value)==null?void 0:N.total)??100],total:((q=g.value)==null?void 0:q.total)??100,layout:"sizes, prev, pager, next",onSizeChange:p,onCurrentChange:p},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),ge=oe(re,[["__scopeId","data-v-c03a0d8a"]]);export{ge as default};
