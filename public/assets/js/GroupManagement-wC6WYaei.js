import{E as M,b as w,c as J,r as P,e as Q,d as R,k as W,v as T,m as X,o as Y,s as Z}from"./element-plus@2.7.7_vue@3.4.32_typescript@5.5.3_-4orX1JGZ.js";import{v as z}from"./@vue_runtime-dom@3.4.32-DNdjNMzo.js";import{i as U}from"./index-DYV93AZk.js";import{d as O,_ as h,$ as ee,o as C,G as E,H as a,i as t,L as m,I as v,m as te,c as ae,a as L,K as q,F as le}from"./@vue_runtime-core@3.4.32-BofAHbgu.js";import{r as _}from"./@vue_reactivity@3.4.32-DksAu7zd.js";import{L as $}from"./@vue_shared@3.4.32-CaCWPAm8.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./lodash-es@4.17.21-BB-zMWwC.js";import"./async-validator@4.2.5-DKvM95Vc.js";import"./@vueuse_core@9.13.0_vue@3.4.32_typescript@5.5.3_-DkVRVfGD.js";import"./@vueuse_shared@9.13.0_vue@3.4.32_typescript@5.5.3_-BbpdFR9m.js";import"./dayjs@1.11.11-Ct2Knyoi.js";import"./@element-plus_icons-vue@2.3.1_vue@3.4.32_typescript@5.5.3_-x2o2c_8n.js";import"./@ctrl_tinycolor@3.6.1-r5W6hzzQ.js";import"./@sxzz_popperjs-es@2.11.7-D9SI2xQl.js";import"./normalize-wheel-es@1.2.0-B6fDCfyv.js";import"./pinia@2.1.7_typescript@5.5.3_vue@3.4.32_typescript@5.5.3_-BSzeUtha.js";import"./vue-demi@0.14.8_vue@3.4.32_typescript@5.5.3_-Dq6ymT-8.js";import"./axios@1.7.2-B4uVmeYG.js";import"./@fingerprintjs_fingerprintjs@4.5.1-5RNCfJbQ.js";import"./tslib@2.6.3-CPxunF3b.js";import"./vue-router@4.4.0_vue@3.4.32_typescript@5.5.3_-ByijA4Eg.js";const ne=n=>U.post("/admin/group",n),ue=n=>U.get(`/admin/group?page=${n.page}&size=${n.size}`),se=n=>U.patch(`/admin/group/${n.id}`,n),de=n=>U.delete("/admin/group",{data:{group_ids:[n.id]}}),ie=n=>U.delete("/admin/group",{data:{group_ids:n}}),re=O({__name:"AddGroup",props:{modelValue:{},modelModifiers:{}},emits:h(["getGroups"],["update:modelValue"]),setup(n,{emit:i}){const b=i,y=ee(n,"modelValue"),f=_(!1),s=_({name:"",count:0,size:0}),r=_(null),S={name:[{required:!0,message:"请输入组名",trigger:"blur"}],count:[{required:!0,message:"请输入可解析文件个数",trigger:"blur"}],size:[{required:!0,message:"请输入可解析大小",trigger:"blur"}]},x=async V=>{if(!(!V||!await V.validate()))try{f.value=!0,await ne(s.value),M.success("添加成功")}finally{f.value=!1}},F=V=>{b("getGroups"),V()},D=()=>{y.value=!1,b("getGroups")};return(V,u)=>{const G=w,k=J,l=P,o=Q,c=R,p=W,I=T;return C(),E(p,{title:"添加用户组",width:"60%",modelValue:y.value,"onUpdate:modelValue":u[5]||(u[5]=d=>y.value=d),"before-close":F},{footer:a(()=>[t(c,{type:"info",onClick:u[3]||(u[3]=d=>D())},{default:a(()=>[m("取消")]),_:1}),t(c,{type:"primary",onClick:u[4]||(u[4]=d=>x(r.value))},{default:a(()=>[m("添加")]),_:1})]),default:a(()=>[v((C(),E(o,{ref_key:"addGroupFormRef",ref:r,model:s.value,rules:S,"label-width":"auto"},{default:a(()=>[t(k,{label:"组名",prop:"name"},{default:a(()=>[t(G,{modelValue:s.value.name,"onUpdate:modelValue":u[0]||(u[0]=d=>s.value.name=d)},null,8,["modelValue"])]),_:1}),t(k,{label:"可解析文件个数",prop:"count"},{default:a(()=>[t(l,{modelValue:s.value.count,"onUpdate:modelValue":u[1]||(u[1]=d=>s.value.count=d)},null,8,["modelValue"])]),_:1}),t(k,{label:"可解析大小",prop:"size"},{default:a(()=>[t(l,{modelValue:s.value.size,"onUpdate:modelValue":u[2]||(u[2]=d=>s.value.size=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[I,f.value]])]),_:1},8,["modelValue"])}}}),pe=O({__name:"GroupManagement",setup(n){const i=_(!1),b=_(15),y=_(1),f=_(),s=_([]),r=async()=>{try{i.value=!0;const l=await ue({page:y.value,size:b.value});f.value=l.data}finally{i.value=!1}},S=async l=>{l.edit=!(l.edit??!1)},x=async l=>{l.edit=!(l.edit??!0),await F(l)},F=async l=>{try{i.value=!0,await se(l),M.success("修改用户组成功")}finally{i.value=!1,await r()}},D=async l=>{try{i.value=!0,await de(l),M.success("删除用户组成功")}finally{i.value=!1,await r()}},V=async()=>{try{i.value=!0;const l=s.value.map(o=>o.id);await ie(l),M.success("批量删除用户组成功")}finally{i.value=!1,await r()}},u=l=>s.value=l;te(r);const G=_(!1),k=()=>G.value=!G.value;return(l,o)=>{var B,N,A;const c=R,p=X,I=w,d=P,j=Y,H=Z,K=T;return C(),ae(le,null,[t(re,{onGetGroups:r,modelValue:G.value,"onUpdate:modelValue":o[0]||(o[0]=e=>G.value=e)},null,8,["modelValue"]),t(c,{type:"primary",onClick:o[1]||(o[1]=e=>r())},{default:a(()=>[m("刷新列表")]),_:1}),t(c,{type:"primary",onClick:o[2]||(o[2]=e=>k())},{default:a(()=>[m("添加用户组")]),_:1}),t(c,{type:"danger",disabled:s.value.length<=0,onClick:o[3]||(o[3]=e=>V())},{default:a(()=>[m(" 批量删除 ")]),_:1},8,["disabled"]),v((C(),E(j,{data:((B=f.value)==null?void 0:B.data)??[],border:"","show-overflow-tooltip":"",class:"table",onSelectionChange:u},{default:a(()=>[t(p,{type:"selection",width:"40"}),t(p,{prop:"id",label:"ID"}),t(p,{prop:"name",label:"组名"},{default:a(({row:e})=>[v(L("span",null,$(e.name),513),[[z,!e.edit]]),v(t(I,{modelValue:e.name,"onUpdate:modelValue":g=>e.name=g},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),t(p,{prop:"count",label:"可解析文件数量"},{default:a(({row:e})=>[v(L("span",null,$(e.count),513),[[z,!e.edit]]),v(t(d,{modelValue:e.count,"onUpdate:modelValue":g=>e.count=g},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),t(p,{prop:"size",label:"可解析大小"},{default:a(({row:e})=>[v(L("span",null,$(e.size),513),[[z,!e.edit]]),v(t(d,{modelValue:e.size,"onUpdate:modelValue":g=>e.size=g},null,8,["modelValue","onUpdate:modelValue"]),[[z,e.edit]])]),_:1}),t(p,{prop:"created_at",label:"创建时间"},{default:a(({row:e})=>[m($(new Date(e.created_at).toLocaleString()),1)]),_:1}),t(p,{prop:"updated_at",label:"更新时间"},{default:a(({row:e})=>[m($(new Date(e.updated_at).toLocaleString()),1)]),_:1}),t(p,{width:"150",label:"操作",fixed:"right"},{default:a(({row:e})=>[e.edit?q("",!0):(C(),E(c,{key:0,size:"small",type:"primary",onClick:g=>S(e)},{default:a(()=>[m(" 编辑 ")]),_:2},1032,["onClick"])),e.edit?(C(),E(c,{key:1,size:"small",type:"primary",onClick:g=>x(e)},{default:a(()=>[m(" 保存 ")]),_:2},1032,["onClick"])):q("",!0),t(c,{size:"small",type:"danger",onClick:g=>D(e)},{default:a(()=>[m("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,i.value]]),t(H,{"current-page":y.value,"onUpdate:currentPage":o[4]||(o[4]=e=>y.value=e),"page-size":b.value,"onUpdate:pageSize":o[5]||(o[5]=e=>b.value=e),"page-sizes":[15,50,100,500,((N=f.value)==null?void 0:N.total)??100],total:((A=f.value)==null?void 0:A.total)??100,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:r,onCurrentChange:r},null,8,["current-page","page-size","page-sizes","total"])],64)}}}),Le=oe(pe,[["__scopeId","data-v-6ac724f9"]]);export{Le as default};
